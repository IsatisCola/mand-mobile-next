import{g as e,m as t,D as o,E as n,s as a,r as s,a as d,c as l,w as c,d as r,t as u,f as i,i as p,k as m,K as f}from"./app.dd25191e.js";import{d as x}from"./index.3c74bb6c.js";import{c as h}from"./index.35410d03.js";import{t as v}from"./index.02bb6ec7.js";import{u as g}from"./index.d3151d16.js";import{a as w,H as y,S as b,e as S}from"./index.22509486.js";var C={title:{type:String},brief:{type:String,default:""},content:{type:String,default:""},visible:{type:Boolean,default:!1},maxlength:{type:Number,default:4},mask:{type:Boolean,default:!1},system:{type:Boolean,default:!1},autoSend:{type:Boolean,default:!0},autoCountdown:{type:Boolean,default:!0},count:{type:Number,default:60},countNormalText:{type:String,default:v("md.captcha.sendCaptcha")},countActiveText:{type:String,default:v("md.captcha.countdown")},isView:{type:Boolean,default:!1}},H=(e,{emit:s})=>{const{popupShow:d,onShow:l,onHide:c,hide:r}=g(e,s),u=t(null),i=t("");o((()=>{i.value.length===e.maxlength&&s(S,i.value)}));const p=t(!1),m=t("");let f,x=e.count;const h=()=>{x&&(p.value=!0,m.value=e.countActiveText.replace("{$1}",`${x}`),f=globalThis.setInterval((()=>{x<=1?v():(x-=1,m.value=e.countActiveText.replace("{$1}",`${x}`))}),1e3))},v=()=>{p.value=!1,m.value=e.countNormalText,clearInterval(f)},w=t(""),y=()=>{e.autoSend&&(s("send",h),e.autoCountdown&&h())},b=a(d,(e=>{e&&y(),b()}));return{popupShow:d,onShow:()=>{u.value.focusHandler(),l()},onHide:()=>{i.value="",c()},hide:r,code:i,errorMsg:w,countBtnText:m,isCounting:p,codeboxRef:u,countdown:h,setError:e=>{n((()=>{w.value=e}))},sendHandler:y}},T=e({name:"MdCaptcha",components:{MdDialog:x,MdCodebox:h},props:C,emits:[w,y,b,S,"send"],setup(e,t){const{popupShow:o,onShow:n,onHide:a,code:s,errorMsg:d,countBtnText:l,isCounting:c,codeboxRef:r,countdown:u,setError:i,sendHandler:p}=H(e,t);return{popupShow:o,onShow:n,onHide:a,code:s,errorMsg:d,countBtnText:l,isCounting:c,codebox:r,countdown:u,setError:i,sendHandler:p}}}),k={class:"md-captcha-content"},B={class:"md-captcha-message"},M={class:"md-captcha-footer"};T.render=function(e,t){const o=s("md-codebox");return d(),l(f(e.isView?"div":"MdDialog"),{modelValue:e.popupShow,"onUpdate:modelValue":t[3]||(t[3]=t=>e.popupShow=t),class:"md-captcha",onShow:e.onShow,onHide:e.onHide},{default:c((()=>[r("div",k,[e.title?(d(),l("p",{key:0,class:"md-captcha-title",textContent:u(e.title)},null,8,["textContent"])):i("v-if",!0),r("div",B,[p(e.$slots,"default",{},(()=>[m(u(e.content),1)]))])]),r(o,{ref:"codebox",modelValue:e.code,"onUpdate:modelValue":t[2]||(t[2]=t=>e.code=t),maxlength:e.maxlength,system:e.system,mask:e.mask,justify:!0,"is-view":e.isView},{default:c((()=>[r("footer",M,[e.errorMsg?(d(),l("div",{key:0,class:"md-captcha-error",textContent:u(e.errorMsg)},null,8,["textContent"])):(d(),l("div",{key:1,class:"md-captcha-brief",textContent:u(e.brief)},null,8,["textContent"])),e.count?(d(),l("button",{key:2,class:"md-captcha-btn",disabled:e.isCounting,onClick:t[1]||(t[1]=(...t)=>e.sendHandler&&e.sendHandler(...t)),textContent:u(e.countBtnText||e.countNormalText)},null,8,["disabled","textContent"])):i("v-if",!0)])])),_:1},8,["modelValue","maxlength","system","mask","is-view"])])),_:3},8,["modelValue","onShow","onHide"])};var V=T;V.install=e=>{e.component(V.name,V)};var j=V;export{j as c};
