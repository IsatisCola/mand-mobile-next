var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(a,l,i)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[l]=i,t=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&n(e,r,t[r]);if(a)for(var r of a(t))i.call(t,r)&&n(e,r,t[r]);return e};import{Q as r,W as s,g as o,m as d,h as u,E as c,s as p,P as v,o as h,O as m,R as k,L as g,a as f,c as w,d as y,F as V,j as x,t as H,r as C,w as b}from"./app.94a7a3e0.js";import{a as I,t as S}from"./index.e7f05278.js";import{m as W,U as _,C as P,a as j,H as A,S as T,g as B,h as O}from"./index.7e667d83.js";import{u as R}from"./index.c8d142a8.js";import{t as M}from"./index.02bb6ec7.js";r.use(s);var $={modelValue:{type:Array,default:[]},data:{type:Array,default:()=>[]},cols:{type:Number,default:1},isView:{type:Boolean,default:!1},invalidValue:{type:Array,default:()=>[]},isCascade:{type:Boolean,default:!1},keepIndex:{type:Boolean,default:!1},lineHeight:{type:Number,default:45}},D=W(),U=(e,{emit:a})=>{let l=null;const i=d([]),n=d(Array(e.cols).fill([])),t=d(-1),s=d(-1),o=d([]),f=d(!1),w=u((()=>(2*e.lineHeight+10)*D)),y=u((()=>e.lineHeight*D)),V=u({get:()=>e.modelValue.reduce((function(a,l,i){const n=e.isCascade?S(i,a):e.data[i],t=n&&n.findIndex((e=>e.value===l));return a.push(t>0?t:0),a}),[]),set:e=>{if(Array.isArray(e)&&e.length>0){const l=e.map(((e,a)=>{var l;return null==(l=n.value[a])?void 0:l[e]})).map((e=>null==e?void 0:e.value));a(_,l)}}}),x=(e,a)=>{l=l||[],l[a]=new r(e,{wheel:{selectedIndex:V.value[a]||0,wheelWrapperClass:"md-picker-view_wheel",wheelItemClass:"md-picker-view_wheel--item",wheelDisabledItemClass:"md-picker-view_wheel--disabled-item"},probeType:3}),l[a].on("scrollEnd",(()=>{const e=l&&l.map((e=>e.getSelectedIndex()))||[];f.value||(t.value=a,-1===s.value&&(s.value=a),o.value=e,W())}))},H=()=>{if(!l){l=[];for(let a=0;a<e.cols;a++)i.value&&x(i.value[a],a)}},C=()=>{A(),c((()=>{H()}))},b=()=>{f.value=!0,l&&l.map((e=>{e.wheelTo(0,0),e.destroy()})),l=null,V.value=[],f.value=!1},I=(a,l,i)=>{if(!e.isCascade)return;if(l>=e.cols)return;const t=S(l,i);if(t)n.value.splice(l,1,t),a&&I(a,++l,i);else for(;l<e.cols;)n.value.splice(l,1,[]),l++};function S(a,l){let i=0,n=e.data[0];for(;i<a;){const e=(null==l?void 0:l[i])||0;n=n[e]&&n[e].children,i++}return n}const W=async()=>{if(e.isCascade){do{I(!1,t.value+1,o.value),t.value++}while(!o.value[t.value]&&t.value<e.cols-1);a=t.value,e.keepIndex||null==(i=null==l?void 0:l[a])||i.wheelTo(0,0),t.value+1>=e.cols&&j()}else j();var a,i},j=()=>{var e;const l=s.value,i=o.value[s.value];a(P,l,i,null==(e=n.value[l])?void 0:e[i]),V.value=[...o.value],s.value=-1},A=()=>{t.value=-1,e.isCascade?I(!0,t.value+1,V.value):n.value=e.data};return p((()=>e.data),(async()=>{b(),C()})),v((()=>{A()})),h((()=>{var e,a;if(null==(e=i.value)?void 0:e.length){const e=null==(a=i.value[0])?void 0:a.getBoundingClientRect();(null==e?void 0:e.width)&&(null==e?void 0:e.height)&&H()}})),m((()=>{i.value=[]})),k((()=>{l&&l.map((e=>{e.refresh()}))})),g((()=>{b()})),{maskerHeight:w,indicatorHeight:y,pickerData:n,selectedIndexs:V,setWheelsRef:e=>{e&&i.value.push(e)},checkInvalid:(a,l)=>(e.invalidValue[a]||[]).indexOf(l.value)>-1,getWheelInstance:()=>l,resetWheel:C,destroyWheel:b,getColumnValues:()=>V.value.map(((e,a)=>{var l;return null==(l=n.value[a])?void 0:l[e]}))}},E=o({name:"MdPickerView",props:$,emits:[_,P],setup(e,a){const{pickerData:l,selectedIndexs:i,maskerHeight:n,indicatorHeight:t,setWheelsRef:r,checkInvalid:s,resetWheel:o,destroyWheel:d,getWheelInstance:u,getColumnValues:c}=U(e,a);return{pickerData:l,selectedIndexs:i,maskerHeight:n,indicatorHeight:t,setWheelsRef:r,checkInvalid:s,resetWheel:o,destroyWheel:d,getWheelInstance:u,getColumnValues:c}}}),N={class:"md-picker-view"},F={class:"md-picker-view_wheel_wrapper"};E.render=function(e,a){return f(),w("div",N,[y("div",{class:"md-picker-view_container",style:{height:`${e.indicatorHeight+2*e.maskerHeight}px`}},[y("div",{class:"\n          md-picker-view_masker md-picker-view_masker--top\n        ",style:{height:`${e.maskerHeight}px`}},null,4),y("div",{class:"\n          md-picker-view_masker\n          md-picker-view_masker--bottom\n        ",style:{height:`${e.maskerHeight}px`}},null,4),y("div",F,[(f(!0),w(V,null,x(e.pickerData,((a,l)=>(f(),w("div",{ref:e.setWheelsRef,key:l,class:"md-picker-view_wheel_column"},[y("ul",{class:"md-picker-view_wheel",style:{marginTop:`${e.maskerHeight}px`}},[(f(!0),w(V,null,x(a,((a,i)=>(f(),w("li",{key:a.value,class:["md-picker-view_wheel--item",{active:i===(e.selectedIndexs&&e.selectedIndexs[l]),"md-picker-view_wheel--disabled-item":e.checkInvalid(l,a)}],style:{height:`${e.indicatorHeight}px`,lineHeight:`${e.indicatorHeight}px`}},H(a.text),7)))),128))],4)],512)))),128))])],4)])};var L=E,Q=[_,j,A,T,P,B,O],q={visible:{type:Boolean,default:!1},title:{type:String,default:""},describe:{type:String,default:""},okText:{type:String,default:M("md.picker.confirm")},cancelText:{type:String,default:M("md.picker.cancel")},largeRadius:{type:Boolean,default:!1},maskClosable:{type:Boolean,default:!0}},z=(e,{emit:a})=>{const l=d(null),{popupShow:i,onHide:n,onShow:t,hide:r}=R(e,a);p(i,(a=>{a&&(o.value=e.modelValue,c((()=>{var e;l.value&&(null==(e=l.value)||e.resetWheel())})))}));const s=()=>{var e;l.value&&(null==(e=l.value)||e.destroyWheel()),r()},o=d(e.modelValue),v=u((()=>""!==e.okText));return p(o,(l=>{!v.value&&Array.isArray(e.modelValue)?a(_,l):o.value&&a(_,o.value)})),{pickerView:l,popupShow:i,innerValue:o,onHide:()=>{var e;l.value&&(null==(e=l.value)||e.destroyWheel()),n()},onShow:()=>{t()},confirmHandler:()=>{Array.isArray(o.value)?o.value.length>0&&a(_,o.value):o.value&&a(_,o.value),a(B),s()},cancelHandler:()=>{a(O),s()},onPickerChange:(e,l,i)=>{a(P,e,l,i)}}},G=o({name:"MdPicker",components:{MdPopup:I,MdPopupTitleBar:S,MdPickerView:L},props:t(t({},$),q),emits:Q,setup(e,a){const{popupShow:l,innerValue:i,pickerView:n,onHide:t,onShow:r,cancelHandler:s,confirmHandler:o,onPickerChange:d}=z(e,a);return{popupShow:l,innerValue:i,pickerView:n,onHide:t,onShow:r,cancelHandler:s,confirmHandler:o,onPickerChange:d,getColumnValues:()=>{var e;return null==(e=n.value)?void 0:e.getColumnValues()}}}}),J={class:"md-picker"};G.render=function(e,a){const l=C("md-picker-view"),i=C("md-popup-title-bar"),n=C("md-popup");return f(),w("div",J,[e.isView?(f(),w(l,{key:0,ref:"pickerView",modelValue:e.innerValue,"onUpdate:modelValue":a[1]||(a[1]=a=>e.innerValue=a),data:e.data,cols:e.cols,"invalid-value":e.invalidValue,"is-cascade":e.isCascade,"keep-index":e.keepIndex,"line-height":e.lineHeight,onChange:e.onPickerChange},null,8,["modelValue","data","cols","invalid-value","is-cascade","keep-index","line-height","onChange"])):(f(),w(n,{key:1,ref:"popup",modelValue:e.popupShow,"onUpdate:modelValue":a[3]||(a[3]=a=>e.popupShow=a),class:"inner-popup",position:"bottom","mask-closable":e.maskClosable,"prevent-scroll":!0,onShow:e.onShow,onHide:e.onHide,onMaskClick:e.cancelHandler},{default:b((()=>[y(i,{title:e.title,describe:e.describe,"ok-text":e.okText,"cancel-text":e.cancelText,"large-radius":e.largeRadius,onConfirm:e.confirmHandler,onCancel:e.cancelHandler},null,8,["title","describe","ok-text","cancel-text","large-radius","onConfirm","onCancel"]),y(l,{ref:"pickerView",modelValue:e.innerValue,"onUpdate:modelValue":a[2]||(a[2]=a=>e.innerValue=a),data:e.data,cols:e.cols,"invalid-value":e.invalidValue,"is-cascade":e.isCascade,"keep-index":e.keepIndex,"line-height":e.lineHeight,onChange:e.onPickerChange},null,8,["modelValue","data","cols","invalid-value","is-cascade","keep-index","line-height","onChange"])])),_:1},8,["modelValue","mask-closable","onShow","onHide","onMaskClick"]))])};var K=G;K.install=e=>{e.component(K.name,K)};var X=K;export{q as a,X as b,L as p,z as u};
