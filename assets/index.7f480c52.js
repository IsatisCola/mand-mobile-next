var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(a,l,i)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[l]=i,t=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&n(e,r,t[r]);if(a)for(var r of a(t))i.call(t,r)&&n(e,r,t[r]);return e};import{ae as r,af as s,ag as o,g as d,U as u,I as c,s as p,h as v,W as h,x as m,aa as k,o as g,a6 as f,ah as w,v as y,a as V,c as x,d as H,F as C,j as b,t as I,G as S,H as W,S as _,a8 as P,a9 as A,J as T,r as j,k as B}from"./app.31d0426a.js";import{a as M,t as O}from"./index.23e46de0.js";import{t as R}from"./index.02bb6ec7.js";r.use(s);var $={modelValue:{type:Array,default:[]},data:{type:Array,default:()=>[]},cols:{type:Number,default:1},isView:{type:Boolean,default:!1},invalidValue:{type:Array,default:()=>[]},isCascade:{type:Boolean,default:!1},keepIndex:{type:Boolean,default:!1},lineHeight:{type:Number,default:45}},D=o(),U=(e,{emit:a})=>{let l=null;const i=p([]),n=p(Array(e.cols).fill([])),t=p(-1),s=p(-1),o=p([]),d=p(!1),V=v((()=>(2*e.lineHeight+10)*D)),x=v((()=>e.lineHeight*D)),H=v({get:()=>e.modelValue.reduce((function(a,l,i){const n=e.isCascade?_(i,a):e.data[i],t=n&&n.findIndex((e=>e.value===l));return a.push(t>0?t:0),a}),[]),set:e=>{if(Array.isArray(e)&&e.length>0){const l=e.map(((e,a)=>{var l;return null==(l=n.value[a])?void 0:l[e]})).map((e=>null==e?void 0:e.value));a(u,l)}}}),C=(e,a)=>{l=l||[],l[a]=new r(e,{wheel:{selectedIndex:H.value[a]||0,wheelWrapperClass:"md-picker-view_wheel",wheelItemClass:"md-picker-view_wheel--item",wheelDisabledItemClass:"md-picker-view_wheel--disabled-item"},probeType:3}),l[a].on("scrollEnd",(()=>{const e=l&&l.map((e=>e.getSelectedIndex()))||[];d.value||(t.value=a,-1===s.value&&(s.value=a),o.value=e,P())}))},b=()=>{if(!l){l=[];for(let a=0;a<e.cols;a++)i.value&&C(i.value[a],a)}},I=()=>{T(),h((()=>{b()}))},S=()=>{d.value=!0,l&&l.map((e=>{e.wheelTo(0,0),e.destroy()})),l=null,H.value=[],d.value=!1},W=(a,l,i)=>{if(!e.isCascade)return;if(l>=e.cols)return;const t=_(l,i);if(t)n.value.splice(l,1,t),a&&W(a,++l,i);else for(;l<e.cols;)n.value.splice(l,1,[]),l++};function _(a,l){let i=0,n=e.data[0];for(;i<a;){const e=(null==l?void 0:l[i])||0;n=n[e]&&n[e].children,i++}return n}const P=async()=>{if(e.isCascade){do{W(!1,t.value+1,o.value),t.value++}while(!o.value[t.value]&&t.value<e.cols-1);a=t.value,e.keepIndex||null==(i=null==l?void 0:l[a])||i.wheelTo(0,0),t.value+1>=e.cols&&A()}else A();var a,i},A=()=>{var e;const l=s.value,i=o.value[s.value];a(c,l,i,null==(e=n.value[l])?void 0:e[i]),H.value=[...o.value],s.value=-1},T=()=>{t.value=-1,e.isCascade?W(!0,t.value+1,H.value):n.value=e.data};return m((()=>e.data),(async()=>{S(),I()})),k((()=>{T()})),g((()=>{var e,a;if(null==(e=i.value)?void 0:e.length){const e=null==(a=i.value[0])?void 0:a.getBoundingClientRect();(null==e?void 0:e.width)&&(null==e?void 0:e.height)&&b()}})),f((()=>{i.value=[]})),w((()=>{l&&l.map((e=>{e.refresh()}))})),y((()=>{S()})),{maskerHeight:V,indicatorHeight:x,pickerData:n,selectedIndexs:H,setWheelsRef:e=>{e&&i.value.push(e)},checkInvalid:(a,l)=>(e.invalidValue[a]||[]).indexOf(l.value)>-1,getWheelInstance:()=>l,resetWheel:I,destroyWheel:S,getColumnValues:()=>H.value.map(((e,a)=>{var l;return null==(l=n.value[a])?void 0:l[e]}))}},E=d({name:"MdPickerView",props:$,emits:[u,c],setup(e,a){const{pickerData:l,selectedIndexs:i,maskerHeight:n,indicatorHeight:t,setWheelsRef:r,checkInvalid:s,resetWheel:o,destroyWheel:d,getWheelInstance:u,getColumnValues:c}=U(e,a);return{pickerData:l,selectedIndexs:i,maskerHeight:n,indicatorHeight:t,setWheelsRef:r,checkInvalid:s,resetWheel:o,destroyWheel:d,getWheelInstance:u,getColumnValues:c}}}),N={class:"md-picker-view"},F={class:"md-picker-view_wheel_wrapper"};E.render=function(e,a){return V(),x("div",N,[H("div",{class:"md-picker-view_container",style:{height:`${e.indicatorHeight+2*e.maskerHeight}px`}},[H("div",{class:"\n          md-picker-view_masker md-picker-view_masker--top\n        ",style:{height:`${e.maskerHeight}px`}},null,4),H("div",{class:"\n          md-picker-view_masker\n          md-picker-view_masker--bottom\n        ",style:{height:`${e.maskerHeight}px`}},null,4),H("div",F,[(V(!0),x(C,null,b(e.pickerData,((a,l)=>(V(),x("div",{ref:e.setWheelsRef,key:l,class:"md-picker-view_wheel_column"},[H("ul",{class:"md-picker-view_wheel",style:{marginTop:`${e.maskerHeight}px`}},[(V(!0),x(C,null,b(a,((a,i)=>(V(),x("li",{key:a.value,class:["md-picker-view_wheel--item",{active:i===(e.selectedIndexs&&e.selectedIndexs[l]),"md-picker-view_wheel--disabled-item":e.checkInvalid(l,a)}],style:{height:`${e.indicatorHeight}px`,lineHeight:`${e.indicatorHeight}px`}},I(a.text),7)))),128))],4)],512)))),128))])],4)])};var G=E,J=[u,S,W,_,c,P,A],q={visible:{type:Boolean,default:!1},title:{type:String,default:""},describe:{type:String,default:""},okText:{type:String,default:R("md.picker.confirm")},cancelText:{type:String,default:R("md.picker.cancel")},largeRadius:{type:Boolean,default:!1},maskClosable:{type:Boolean,default:!0}},z=(e,{emit:a})=>{const l=p(null),{popupShow:i,onHide:n,onShow:t,hide:r}=T(e,a);m(i,(a=>{a&&(o.value=e.modelValue,h((()=>{var e;l.value&&(null==(e=l.value)||e.resetWheel())})))}));const s=()=>{var e;l.value&&(null==(e=l.value)||e.destroyWheel()),r()},o=p(e.modelValue),d=v((()=>""!==e.okText));return m(o,(l=>{!d.value&&Array.isArray(e.modelValue)?a(u,l):o.value&&a(u,o.value)})),{pickerView:l,popupShow:i,innerValue:o,onHide:()=>{var e;l.value&&(null==(e=l.value)||e.destroyWheel()),n()},onShow:()=>{t()},confirmHandler:()=>{Array.isArray(o.value)?o.value.length>0&&a(u,o.value):o.value&&a(u,o.value),a(P),s()},cancelHandler:()=>{a(A),s()},onPickerChange:(e,l,i)=>{a(c,e,l,i)}}},K=d({name:"MdPicker",components:{MdPopup:M,MdPopupTitleBar:O,MdPickerView:G},props:t(t({},$),q),emits:J,setup(e,a){const{popupShow:l,innerValue:i,pickerView:n,onHide:t,onShow:r,cancelHandler:s,confirmHandler:o,onPickerChange:d}=z(e,a);return{popupShow:l,innerValue:i,pickerView:n,onHide:t,onShow:r,cancelHandler:s,confirmHandler:o,onPickerChange:d,getColumnValues:()=>{var e;return null==(e=n.value)?void 0:e.getColumnValues()}}}}),L={class:"md-picker"};K.render=function(e,a){const l=j("md-picker-view"),i=j("md-popup-title-bar"),n=j("md-popup");return V(),x("div",L,[e.isView?(V(),x(l,{key:0,ref:"pickerView",modelValue:e.innerValue,"onUpdate:modelValue":a[1]||(a[1]=a=>e.innerValue=a),data:e.data,cols:e.cols,"invalid-value":e.invalidValue,"is-cascade":e.isCascade,"keep-index":e.keepIndex,"line-height":e.lineHeight,onChange:e.onPickerChange},null,8,["modelValue","data","cols","invalid-value","is-cascade","keep-index","line-height","onChange"])):(V(),x(n,{key:1,ref:"popup",modelValue:e.popupShow,"onUpdate:modelValue":a[3]||(a[3]=a=>e.popupShow=a),class:"inner-popup",position:"bottom","mask-closable":e.maskClosable,"prevent-scroll":!0,onShow:e.onShow,onHide:e.onHide,onMaskClick:e.cancelHandler},{default:B((()=>[H(i,{title:e.title,describe:e.describe,"ok-text":e.okText,"cancel-text":e.cancelText,"large-radius":e.largeRadius,onConfirm:e.confirmHandler,onCancel:e.cancelHandler},null,8,["title","describe","ok-text","cancel-text","large-radius","onConfirm","onCancel"]),H(l,{ref:"pickerView",modelValue:e.innerValue,"onUpdate:modelValue":a[2]||(a[2]=a=>e.innerValue=a),data:e.data,cols:e.cols,"invalid-value":e.invalidValue,"is-cascade":e.isCascade,"keep-index":e.keepIndex,"line-height":e.lineHeight,onChange:e.onPickerChange},null,8,["modelValue","data","cols","invalid-value","is-cascade","keep-index","line-height","onChange"])])),_:1},8,["modelValue","mask-closable","onShow","onHide","onMaskClick"]))])};var Q=K;Q.install=e=>{e.component(Q.name,Q)};var X=Q;export{q as a,X as b,G as p,z as u};
